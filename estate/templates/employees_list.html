{% extends "base.html" %}

{% load currency %}

{% block title %}Employees{% endblock %}

{% block content %}
<div class="dashboard-card mb-4">
 <div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="dashboard-title mb-0">Employees</h2>

  <div class="d-flex gap-2">
   <a href="{% url 'add_employee' %}" class="btn btn-outline-main btn-sm">
    Add Employee
   </a>

   <a href="{% url 'expenses_ledger' %}" class="btn btn-outline-main btn-sm">
    Back to Expenses
   </a>
  </div>
 </div>

 <div class="table-responsive">
  <table class="table table-striped align-middle">
   <thead>
    <tr>
     <th>Name</th>
     <th>Role</th>
     <th>Status</th>
     <th class="text-end">Monthly Salary</th>
     <th class="text-end">Actions</th>
    </tr>
   </thead>
   <tbody>
    {% for e in employees %}
    <tr>
     <td>{{ e.name }}</td>
     <td>
      {% if e.role %} {{ e.role }} {% else %}
      <span class="text-muted">â€”</span>
      {% endif %}
     </td>
     <td>
      {% if e.active %}
      <span class="badge bg-success">Active</span>
      {% else %}
      <span class="badge bg-secondary">Inactive</span>
      {% endif %}
     </td>
     <td class="text-end">{{ e.monthly_salary|ugx }}</td>
     <td class="text-end">
      {% if e.active %}
      <a href="{% url 'pay_salary' e.id %}" class="btn btn-sm btn-outline-main">
       Pay Salary
      </a>

      <form method="post" action="{% url 'toggle_employee_active' e.id %}" style="display:inline;">
       {% csrf_token %}
       <button type="submit" class="btn btn-sm btn-outline-danger ms-1">
        Deactivate
       </button>
      </form>
      {% else %}
      <form method="post" action="{% url 'toggle_employee_active' e.id %}" style="display:inline;">
       {% csrf_token %}
       <button type="submit" class="btn btn-sm btn-outline-success">
        Reactivate
       </button>
      </form>
      {% endif %}
     </td>
    </tr>
    {% empty %}
    <tr>
     <td colspan="5" class="text-center text-muted py-4">
      No employees added yet.
     </td>
    </tr>
    {% endfor %}
   </tbody>
  </table>
 </div>
</div>
{% endblock %}